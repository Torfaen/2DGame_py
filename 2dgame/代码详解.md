# ä»£ç è¯¦è§£ - ç»™è€å¸ˆçš„å›ç­”å‡†å¤‡

æœ¬æ–‡æ¡£è¯¦ç»†è§£é‡Šé¡¹ç›®ä¸­çš„å…³é”®ä»£ç ï¼Œå¸®åŠ©ä½ åœ¨è€å¸ˆæé—®æ—¶èƒ½å¤Ÿå›ç­”ã€‚

---

## ä¸€ã€æ¸¸æˆä¸»å¾ªç¯ï¼ˆgame_manager.pyï¼‰

### 1.1 æ¸¸æˆåˆå§‹åŒ–çš„æµç¨‹

```python
def init(self):
    pygame.init()                    # 1. åˆå§‹åŒ–Pygameåº“
    self._init_window()              # 2. åˆ›å»ºæ¸¸æˆçª—å£
    self._load_maps()                # 3. åŠ è½½åœ°å›¾æ•°æ®
    self._load_players()             # 4. åˆ›å»ºç©å®¶å¯¹è±¡
    self._init_groups()              # 5. åˆå§‹åŒ–æ¸¸æˆå¯¹è±¡ç»„
```

**ä¸ºä»€ä¹ˆéœ€è¦åˆå§‹åŒ–ï¼Ÿ**
- Pygameéœ€è¦åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨
- çª—å£æ˜¯æ¸¸æˆæ˜¾ç¤ºçš„åŸºç¡€
- åœ°å›¾å’Œç©å®¶æ˜¯æ¸¸æˆçš„æ ¸å¿ƒå…ƒç´ 
- ä½¿ç”¨`pygame.sprite.Group`å¯ä»¥æ–¹ä¾¿åœ°ç®¡ç†å¤šä¸ªåŒç±»å¯¹è±¡

### 1.2 ä¸»æ¸¸æˆå¾ªç¯

```python
def run(self):
    while self.running:               # æ¸¸æˆè¿è¡Œæ ‡å¿—
        self.clock.tick(60)          # é™åˆ¶å¸§ç‡ä¸º60 FPS
        self._handle_events()        # å¤„ç†è¾“å…¥äº‹ä»¶ï¼ˆæŒ‰é”®ã€å…³é—­çª—å£ç­‰ï¼‰
        self.update()                # æ›´æ–°æ¸¸æˆçŠ¶æ€
        self._render()               # ç»˜åˆ¶ç”»é¢
        pygame.display.update()      # æ›´æ–°å±å¹•æ˜¾ç¤º
```

**å…³é”®ç‚¹**ï¼š
- `clock.tick(60)`: ç¡®ä¿æ¸¸æˆä»¥60å¸§/ç§’è¿è¡Œï¼Œä¿æŒæµç•…
- å¾ªç¯é¡ºåºï¼šäº‹ä»¶ â†’ æ›´æ–° â†’ æ¸²æŸ“ï¼Œè¿™æ˜¯æ¸¸æˆçš„æ ‡å‡†æµç¨‹

### 1.3 æ›´æ–°æ¸¸æˆçŠ¶æ€ï¼ˆupdateæ–¹æ³•ï¼‰

```python
def update(self):
    self._update_player()            # æ›´æ–°ç©å®¶ï¼ˆç§»åŠ¨ã€æ”¾ç½®ç‚¸å¼¹ï¼‰
    self._update_item()              # æ›´æ–°é“å…·ï¼ˆæ£€æµ‹æ‹¾å–ï¼‰
    self._update_bomb()              # æ›´æ–°ç‚¸å¼¹ï¼ˆå€’è®¡æ—¶ã€çˆ†ç‚¸ï¼‰
    self._update_explosion()         # æ›´æ–°çˆ†ç‚¸ï¼ˆæ‘§æ¯éšœç¢ç‰©ã€ä¼¤å®³ç©å®¶ï¼‰
    self._check_game_state()         # æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸ
```

**æ‰§è¡Œé¡ºåºå¾ˆé‡è¦**ï¼š
1. å…ˆæ›´æ–°ç©å®¶ï¼ˆç©å®¶ç§»åŠ¨ã€æ”¾ç½®ç‚¸å¼¹ï¼‰
2. å†æ›´æ–°é“å…·ï¼ˆç©å®¶å¯èƒ½æ‹¾å–é“å…·ï¼‰
3. ç„¶åæ›´æ–°ç‚¸å¼¹ï¼ˆç‚¸å¼¹å€’è®¡æ—¶ï¼‰
4. æœ€åå¤„ç†çˆ†ç‚¸ï¼ˆçˆ†ç‚¸å½±å“ç©å®¶å’Œéšœç¢ç‰©ï¼‰

---

## äºŒã€ç©å®¶ç³»ç»Ÿï¼ˆplayer.pyï¼‰

### 2.1 ç©å®¶åˆå§‹åŒ–

```python
def __init__(self, id, x, y, controls, ...):
    self.id = id                     # ç©å®¶ID
    self.rect = self.image.get_rect() # ç©å®¶çš„çŸ©å½¢ï¼ˆä½ç½®å’Œå¤§å°ï¼‰
    self.rect.x = x                   # åˆå§‹Xåæ ‡
    self.rect.y = y                   # åˆå§‹Yåæ ‡
    self.controls = controls          # æ§åˆ¶é”®ä½ï¼ˆå­—å…¸ï¼‰
    self.speed = speed                # ç§»åŠ¨é€Ÿåº¦
    self.bombs_count = bombs_count    # æœ€å¤šå¯æ”¾ç½®çš„ç‚¸å¼¹æ•°
    self.bomb_power = bomb_power      # ç‚¸å¼¹å¨åŠ›
```

**å…³é”®å±æ€§è§£é‡Š**ï¼š
- `rect`: Pygameçš„çŸ©å½¢å¯¹è±¡ï¼Œç”¨äºç¢°æ’æ£€æµ‹å’Œä½ç½®ç®¡ç†
- `controls`: å­˜å‚¨æŒ‰é”®æ˜ å°„ï¼Œå¦‚`{"up": pygame.K_w, "down": pygame.K_s}`
- `speed`: æ¯å¸§ç§»åŠ¨çš„åƒç´ æ•°

### 2.2 å¤„ç†è¾“å…¥

```python
def handle_input(self):
    key = pygame.key.get_pressed()    # è·å–å½“å‰æ‰€æœ‰æŒ‰é”®çŠ¶æ€
    if key[self.controls["left"]]:   # å¦‚æœæŒ‰ä¸‹å·¦é”®
        dx = -self.speed             # å‘å·¦ç§»åŠ¨ï¼ˆdxä¸ºè´Ÿï¼‰
        dy = 0
        self.direction = "left"      # è®¾ç½®æœå‘
        self.moved = True
    # ... å…¶ä»–æ–¹å‘ç±»ä¼¼
    return dx, dy                     # è¿”å›ç§»åŠ¨æ–¹å‘
```

**ä¸ºä»€ä¹ˆè¿”å›dx, dyï¼Ÿ**
- `dx`: Xæ–¹å‘çš„ç§»åŠ¨é‡ï¼ˆå·¦å³ï¼‰
- `dy`: Yæ–¹å‘çš„ç§»åŠ¨é‡ï¼ˆä¸Šä¸‹ï¼‰
- è¿™æ ·å¯ä»¥åœ¨ç§»åŠ¨æ–¹æ³•ä¸­ç»Ÿä¸€å¤„ç†ç¢°æ’æ£€æµ‹

### 2.3 ç§»åŠ¨å’Œç¢°æ’æ£€æµ‹

```python
def move(self, dx, dy, collision_rects):
    # 1. è®°å½•ç§»åŠ¨å‰çš„ä½ç½®
    old_x, old_y = self.rect.x, self.rect.y
    
    # 2. å°è¯•ç§»åŠ¨
    self.rect.x += dx
    self.rect.y += dy
    
    # 3. æ£€æµ‹ç¢°æ’
    for rect in collision_rects:
        if self._if_in_collision(rect, old_x, old_y):
            # å¦‚æœç¢°æ’ï¼Œå›æ»šä½ç½®
            self._revert_move(old_x, old_y, ...)
            break
```

**ç¢°æ’æ£€æµ‹é€»è¾‘**ï¼š
1. å…ˆç§»åŠ¨ä½ç½®
2. æ£€æŸ¥æ˜¯å¦ä¸éšœç¢ç‰©ç¢°æ’
3. å¦‚æœç¢°æ’ï¼Œæ¢å¤åˆ°ç§»åŠ¨å‰çš„ä½ç½®

### 2.4 æ”¾ç½®ç‚¸å¼¹

```python
def place_bomb(self, bombs_group, map_obj):
    keys = pygame.key.get_pressed()
    # æ£€æŸ¥æ˜¯å¦æŒ‰ä¸‹æ”¾ç½®é”®ï¼Œä¸”å†·å´æ—¶é—´å·²è¿‡
    if keys[self.controls["shift"]] and self.bomb_cooldown <= 0:
        self.handle_bomb_group(bombs_group, map_obj)

def handle_bomb_group(self, bombs_group, map_obj):
    # 1. æ¸…ç†å·²çˆ†ç‚¸çš„ç‚¸å¼¹
    self.bombs_active = [b for b in self.bombs_active if not b.exploded]
    
    # 2. æ£€æŸ¥æ˜¯å¦è¾¾åˆ°æœ€å¤§ç‚¸å¼¹æ•°
    if len(self.bombs_active) >= self.bombs_count:
        return None
    
    # 3. è·å–å½“å‰ä½ç½®çš„æ ¼å­åæ ‡
    grid_x, grid_y = self._get_feetgrid_position()
    x = grid_x * TILE_SIZE
    y = grid_y * TILE_SIZE
    
    # 4. æ£€æŸ¥è¯¥ä½ç½®æ˜¯å¦å·²æœ‰ç‚¸å¼¹
    for bomb in self.bombs_active:
        if bomb.rect.x == x and bomb.rect.y == y:
            return None
    
    # 5. åˆ›å»ºæ–°ç‚¸å¼¹
    bomb_new = Bomb(x, y, self.bomb_power, map_obj=map_obj)
    self.bombs_active.append(bomb_new)
    bombs_group.add(bomb_new)
    self.bomb_cooldown = self.bomb_cooldown_max  # å¼€å§‹å†·å´
```

**å…³é”®é™åˆ¶**ï¼š
- æœ€å¤šåŒæ—¶æ”¾ç½®`bombs_count`ä¸ªç‚¸å¼¹
- åŒä¸€ä½ç½®ä¸èƒ½æ”¾ç½®å¤šä¸ªç‚¸å¼¹
- æ”¾ç½®åæœ‰å†·å´æ—¶é—´ï¼ˆé˜²æ­¢è¿ç»­å¿«é€Ÿæ”¾ç½®ï¼‰

---

## ä¸‰ã€ç‚¸å¼¹ç³»ç»Ÿï¼ˆbomb.pyï¼‰

### 3.1 ç‚¸å¼¹åˆå§‹åŒ–

```python
def __init__(self, x, y, power, map_obj=None):
    self.rect.x = x                  # ç‚¸å¼¹ä½ç½®ï¼ˆæ ¼å­å¯¹é½ï¼‰
    self.rect.y = y
    self.power = power               # çˆ†ç‚¸å¨åŠ›
    self.timer = 0                   # å€’è®¡æ—¶
    self.exploded = False            # æ˜¯å¦å·²çˆ†ç‚¸
    self.map_obj = map_obj
    if self.map_obj:
        self._generate_collision(x, y)  # æ”¾ç½®æ—¶åˆ›å»ºç¢°æ’ï¼ˆé˜»æŒ¡ç©å®¶ï¼‰
```

### 3.2 ç‚¸å¼¹æ›´æ–°

```python
def update(self):
    self._update_frame_index()       # æ›´æ–°åŠ¨ç”»å¸§
    self._update_bomb_status()       # æ›´æ–°ç‚¸å¼¹çŠ¶æ€
    self._update_alive()             # æ£€æŸ¥æ˜¯å¦ç§»é™¤

def _update_bomb_status(self):
    self.timer += 1                  # æ¯å¸§å¢åŠ 1
    # 3.5ç§’åçˆ†ç‚¸ï¼ˆ60 FPS * 3.5 = 210å¸§ï¼‰
    if self.timer >= FPS * 3.5 and not self.exploded:
        self.exploded = True
```

**æ—¶é—´è®¡ç®—**ï¼š
- 60 FPS = æ¯ç§’60å¸§
- 3.5ç§’ = 210å¸§
- æ¯å¸§`timer`åŠ 1ï¼Œè¾¾åˆ°210æ—¶çˆ†ç‚¸

---

## å››ã€çˆ†ç‚¸ç³»ç»Ÿï¼ˆgame_manager.pyä¸­çš„å¤„ç†ï¼‰

### 4.1 è§¦å‘çˆ†ç‚¸

```python
def trigger_explosion(self, bomb):
    bomb.alive = False
    bomb.remove_collision(...)       # ç§»é™¤ç‚¸å¼¹çš„ç¢°æ’ï¼ˆç©å®¶å¯ä»¥é€šè¿‡ï¼‰
    # åˆ›å»ºçˆ†ç‚¸å¯¹è±¡
    explosion = Explosion(bomb.rect.x, bomb.rect.y, bomb.power, self.map_obj)
    return explosion
```

### 4.2 è®¡ç®—çˆ†ç‚¸èŒƒå›´

```python
def get_destroy_blocks(self, explosion):
    destroyed_blocks = []
    e_grid_x = explosion.rect.x // TILE_SIZE
    e_grid_y = explosion.rect.y // TILE_SIZE
    
    # å››ä¸ªæ–¹å‘ï¼šä¸Šã€ä¸‹ã€å·¦ã€å³
    directions = [(0, -1), (0, 1), (-1, 0), (1, 0)]
    
    for dx, dy in directions:
        # ä»1æ ¼åˆ°poweræ ¼ï¼Œé€æ ¼æ£€æŸ¥
        for i in range(1, explosion.power + 1):
            check_grid_x = e_grid_x + dx * i
            check_grid_y = e_grid_y + dy * i
            
            # è¾¹ç•Œæ£€æŸ¥
            if (è¶…å‡ºè¾¹ç•Œ):
                break  # åœæ­¢è¯¥æ–¹å‘
            
            # é‡åˆ°ä¸å¯æ‘§æ¯çš„éšœç¢ç‰©ï¼Œåœæ­¢ä½†ä¸è®°å½•
            if collision_map[check_grid_y][check_grid_x] == 2:
                break
            
            # é‡åˆ°å¯æ‘§æ¯çš„éšœç¢ç‰©ï¼Œè®°å½•å¹¶åœæ­¢
            if barrier_map[check_grid_y][check_grid_x] != "empty":
                destroyed_blocks.append((check_grid_x, check_grid_y))
                break
    
    return destroyed_blocks
```

**çˆ†ç‚¸é€»è¾‘**ï¼š
1. ä»ç‚¸å¼¹ä¸­å¿ƒå‘å››ä¸ªæ–¹å‘æ‰©æ•£
2. æ¯ä¸ªæ–¹å‘æ‰©æ•£`power`æ ¼
3. é‡åˆ°ä¸å¯æ‘§æ¯éšœç¢ç‰©åœæ­¢
4. é‡åˆ°å¯æ‘§æ¯éšœç¢ç‰©è®°å½•å¹¶åœæ­¢

### 4.3 è¿é”çˆ†ç‚¸

```python
def _handle_chain_explosion(self, explosion):
    for bomb in list(self.bombs_group):
        if not bomb.exploded:        # åªå¤„ç†æœªçˆ†ç‚¸çš„ç‚¸å¼¹
            bomb_grid_x = bomb.rect.x // TILE_SIZE
            bomb_grid_y = bomb.rect.y // TILE_SIZE
            
            # å¦‚æœç‚¸å¼¹åœ¨çˆ†ç‚¸èŒƒå›´å†…
            if explosion.contains(bomb_grid_x, bomb_grid_y):
                bomb.exploded = True  # è§¦å‘è¿é”çˆ†ç‚¸
```

**è¿é”çˆ†ç‚¸**ï¼š
- ä¸€ä¸ªç‚¸å¼¹çˆ†ç‚¸æ—¶ï¼Œæ£€æŸ¥å…¶ä»–ç‚¸å¼¹æ˜¯å¦åœ¨çˆ†ç‚¸èŒƒå›´å†…
- å¦‚æœåœ¨èŒƒå›´å†…ï¼Œç«‹å³è§¦å‘è¯¥ç‚¸å¼¹çˆ†ç‚¸

---

## äº”ã€åœ°å›¾ç³»ç»Ÿï¼ˆmap.pyï¼‰

### 5.1 åœ°å›¾ä¸‰å±‚ç»“æ„

```python
# ç¢°æ’å±‚ï¼ˆcollision_mapï¼‰
# 0 = å¯é€šè¡Œ
# 1 = å¯æ‘§æ¯éšœç¢ç‰©
# 2 = ä¸å¯æ‘§æ¯éšœç¢ç‰©

# éšœç¢ç‰©å±‚ï¼ˆbarrier_mapï¼‰
# "empty" = ç©º
# "house" = æˆ¿å­ï¼ˆå¯æ‘§æ¯ï¼‰
# "wall" = å¢™å£ï¼ˆä¸å¯æ‘§æ¯ï¼‰

# åœ°æ¿å±‚ï¼ˆfloor_mapï¼‰
# æ˜¾ç¤ºåœ°é¢è´´å›¾
```

### 5.2 ç»˜åˆ¶é¡ºåºï¼ˆZ-orderï¼‰

```python
def _handle_draw_obj(self):
    drawables = []
    
    # 1. æ·»åŠ åœ°å›¾ç‰©ä»¶
    for y in range(len(self.barrier_map)):
        for x in range(len(self.barrier_map[y])):
            feet_y = pos_y + tile_size  # åº•éƒ¨Yåæ ‡ä½œä¸ºæ’åºä¾æ®
            drawables.append(("tile", tile_name, pos_x, pos_y, feet_y))
    
    # 2. æ·»åŠ ç©å®¶
    for player_obj in self.players_group:
        drawables.append(("player", player_obj, ..., player_obj.feet_rect.y))
    
    # 3. æŒ‰åº•éƒ¨Yåæ ‡æ’åºï¼ˆä»ä¸‹åˆ°ä¸Šï¼‰
    drawables.sort(key=lambda obj: obj[4])
    
    return drawables
```

**ä¸ºä»€ä¹ˆéœ€è¦æ’åºï¼Ÿ**
- å®ç°æ­£ç¡®çš„é®æŒ¡å…³ç³»
- Yåæ ‡å°çš„ï¼ˆåœ¨ä¸Šæ–¹ï¼‰å…ˆç»˜åˆ¶ï¼ŒYåæ ‡å¤§çš„ï¼ˆåœ¨ä¸‹æ–¹ï¼‰åç»˜åˆ¶
- è¿™æ ·ä¸‹æ–¹çš„ç‰©ä½“ä¼šé®æŒ¡ä¸Šæ–¹çš„ç‰©ä½“ï¼Œç¬¦åˆè§†è§‰ä¹ æƒ¯

### 5.3 ç§»é™¤éšœç¢ç‰©

```python
def remove_barrier(self, grid_x, grid_y):
    # æ£€æŸ¥æ˜¯å¦ä¸å¯æ‘§æ¯
    if self.collision_map[grid_y][grid_x] == 2:
        return
    
    # ä»éšœç¢ç‰©åœ°å›¾ä¸­ç§»é™¤
    self.barrier_map[grid_y][grid_x] = "empty"
    
    # ä»ç¢°æ’åˆ—è¡¨ä¸­ç§»é™¤
    target_rect = pygame.Rect(grid_x * tile_size, grid_y * tile_size, ...)
    self.barrier_rects = [rect for rect in self.barrier_rects 
                         if not rect.collidepoint(target_rect.center)]
```

---

## å…­ã€é“å…·ç³»ç»Ÿï¼ˆitem.pyï¼‰

### 6.1 é“å…·ç”Ÿæˆ

```python
@classmethod
def create_random(cls, rect_x, rect_y):
    # éšæœºé€‰æ‹©ä¸€ä¸ªé“å…·ç±»å‹
    item_name = random.choice(cls.items_keys)
    item_config = cls.items[item_name]
    
    # åˆ›å»ºé“å…·å¯¹è±¡
    item = cls(x=rect_x, y=rect_y, 
               name=item_config["name"],
               effect_type=item_config["effect_type"],
               effect_value=item_config["effect_value"],
               ...)
    return item
```

### 6.2 é“å…·æ•ˆæœ

```python
def get_effect(self):
    return {"type": self.effect_type, "value": self.effect_value}

# åœ¨player.pyä¸­åº”ç”¨æ•ˆæœ
def update_item_effect(self, dict_effect):
    if dict_effect["type"] == "speed":
        self.update_speed(dict_effect["value"])
    elif dict_effect["type"] == "bomb_count":
        self.update_bombs_count(dict_effect["value"])
    # ...
```

---

## ä¸ƒã€å¸¸è§é¢è¯•/æé—®é—®é¢˜

### Q1: æ¸¸æˆå¾ªç¯æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

**A**: æ¸¸æˆå¾ªç¯æ˜¯æ¸¸æˆçš„æ ¸å¿ƒï¼Œæ¯ç§’é’Ÿæ‰§è¡Œ60æ¬¡ï¼š
1. **äº‹ä»¶å¤„ç†**ï¼šæ£€æµ‹ç”¨æˆ·è¾“å…¥ï¼ˆæŒ‰é”®ã€é¼ æ ‡ç­‰ï¼‰
2. **çŠ¶æ€æ›´æ–°**ï¼šæ›´æ–°æ‰€æœ‰æ¸¸æˆå¯¹è±¡çš„çŠ¶æ€ï¼ˆä½ç½®ã€åŠ¨ç”»ã€å€’è®¡æ—¶ç­‰ï¼‰
3. **ç¢°æ’æ£€æµ‹**ï¼šæ£€æµ‹ç‰©ä½“ä¹‹é—´çš„ç¢°æ’
4. **æ¸²æŸ“**ï¼šå°†æ‰€æœ‰å¯¹è±¡ç»˜åˆ¶åˆ°å±å¹•ä¸Š
5. **æ˜¾ç¤ºæ›´æ–°**ï¼šå°†ç”»é¢æ˜¾ç¤ºç»™ç”¨æˆ·

### Q2: ç¢°æ’æ£€æµ‹æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ

**A**: ä½¿ç”¨Pygameçš„çŸ©å½¢ç¢°æ’æ£€æµ‹ï¼š
- æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª`rect`ï¼ˆçŸ©å½¢ï¼‰
- ä½¿ç”¨`rect.colliderect(other_rect)`æ£€æµ‹ä¸¤ä¸ªçŸ©å½¢æ˜¯å¦é‡å 
- å¦‚æœé‡å ï¼Œè¯´æ˜å‘ç”Ÿç¢°æ’

### Q3: ä¸ºä»€ä¹ˆä½¿ç”¨é…ç½®æ–‡ä»¶è€Œä¸æ˜¯ç¡¬ç¼–ç ï¼Ÿ

**A**: 
1. **çµæ´»æ€§**ï¼šä¿®æ”¹å‚æ•°ä¸éœ€è¦æ”¹ä»£ç ï¼Œé‡æ–°ç¼–è¯‘
2. **å¯ç»´æŠ¤æ€§**ï¼šé…ç½®é›†ä¸­ç®¡ç†ï¼Œæ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹
3. **å¯æ‰©å±•æ€§**ï¼šå¯ä»¥è½»æ¾æ·»åŠ æ–°è§’è‰²ã€é“å…·ç­‰
4. **å›¢é˜Ÿåä½œ**ï¼šä¸åŒå¼€å‘è€…å¯ä»¥ä½¿ç”¨ä¸åŒé…ç½®

### Q4: å¦‚ä½•ä¼˜åŒ–æ¸¸æˆæ€§èƒ½ï¼Ÿ

**A**: 
1. **ä½¿ç”¨ç²¾çµç»„ï¼ˆGroupï¼‰**ï¼šæ‰¹é‡å¤„ç†åŒç±»å¯¹è±¡
2. **é™åˆ¶å¸§ç‡**ï¼šä½¿ç”¨`clock.tick()`ç¡®ä¿ä¸ä¼šè¿‡å¿«
3. **åªæ›´æ–°å¯è§åŒºåŸŸ**ï¼šå¯¹äºå¤§åœ°å›¾ï¼Œå¯ä»¥åªæ¸²æŸ“å¯è§éƒ¨åˆ†
4. **ç¼“å­˜å›¾ç‰‡**ï¼šé¿å…é‡å¤åŠ è½½å›¾ç‰‡
5. **å‡å°‘ä¸å¿…è¦çš„è®¡ç®—**ï¼šåªåœ¨éœ€è¦æ—¶è¿›è¡Œç¢°æ’æ£€æµ‹

### Q5: ç‚¸å¼¹çš„çˆ†ç‚¸èŒƒå›´æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ

**A**: 
1. ç‚¸å¼¹çˆ†ç‚¸æ—¶ï¼Œå‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘æ‰©æ•£
2. æ¯ä¸ªæ–¹å‘æ‰©æ•£`power`æ ¼ï¼ˆç‚¸å¼¹å¨åŠ›ï¼‰
3. æ¯æ ¼æ£€æŸ¥æ˜¯å¦æœ‰éšœç¢ç‰©ï¼š
   - å¦‚æœé‡åˆ°ä¸å¯æ‘§æ¯éšœç¢ç‰©ï¼Œåœæ­¢è¯¥æ–¹å‘
   - å¦‚æœé‡åˆ°å¯æ‘§æ¯éšœç¢ç‰©ï¼Œè®°å½•å¹¶åœæ­¢è¯¥æ–¹å‘
4. ä½¿ç”¨æ ¼å­åæ ‡ï¼ˆgrid_x, grid_yï¼‰è€Œä¸æ˜¯åƒç´ åæ ‡ï¼Œä¾¿äºè®¡ç®—

### Q6: æ¸¸æˆçš„ç»˜åˆ¶é¡ºåºæ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ

**A**: 
1. å°†æ‰€æœ‰éœ€è¦ç»˜åˆ¶çš„å¯¹è±¡æ”¾å…¥åˆ—è¡¨
2. æ¯ä¸ªå¯¹è±¡è®°å½•å…¶åº•éƒ¨Yåæ ‡ï¼ˆé”šç‚¹ï¼‰
3. æŒ‰Yåæ ‡ä»å°åˆ°å¤§æ’åº
4. ä¾æ¬¡ç»˜åˆ¶ï¼Œå®ç°æ­£ç¡®çš„é®æŒ¡å…³ç³»

### Q7: å¦‚ä½•å¤„ç†ç©å®¶åŒæ—¶æ”¾ç½®å¤šä¸ªç‚¸å¼¹ï¼Ÿ

**A**: 
1. æ¯ä¸ªç©å®¶ç»´æŠ¤ä¸€ä¸ª`bombs_active`åˆ—è¡¨
2. æ”¾ç½®ç‚¸å¼¹å‰æ£€æŸ¥åˆ—è¡¨é•¿åº¦æ˜¯å¦å°äº`bombs_count`
3. æ”¾ç½®åæ£€æŸ¥è¯¥ä½ç½®æ˜¯å¦å·²æœ‰ç‚¸å¼¹
4. ä½¿ç”¨å†·å´æ—¶é—´é˜²æ­¢è¿ç»­å¿«é€Ÿæ”¾ç½®

### Q8: é“å…·ç³»ç»Ÿæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

**A**: 
1. ç‚¸æ¯éšœç¢ç‰©æ—¶ï¼Œæœ‰30%æ¦‚ç‡ç”Ÿæˆé“å…·
2. é“å…·éšæœºä»é…ç½®ä¸­é€‰æ‹©ç±»å‹
3. ç©å®¶æ‹¾å–é“å…·æ—¶ï¼Œæ£€æµ‹ç¢°æ’ï¼ˆ`hit_box`ï¼‰
4. åº”ç”¨é“å…·æ•ˆæœï¼ˆå¢åŠ é€Ÿåº¦ã€ç‚¸å¼¹æ•°é‡ç­‰ï¼‰
5. é“å…·æ¶ˆå¤±

---

## å…«ã€ä»£ç ä¸­çš„è®¾è®¡æ¨¡å¼

### 1. å•ä¾‹æ¨¡å¼ï¼ˆéƒ¨åˆ†å®ç°ï¼‰
- `GameManager`åœ¨æ•´ä¸ªæ¸¸æˆä¸­åªæœ‰ä¸€ä¸ªå®ä¾‹

### 2. ç»„ä»¶æ¨¡å¼
- æ¯ä¸ªæ¸¸æˆå¯¹è±¡ï¼ˆPlayerã€Bombã€Itemï¼‰éƒ½æ˜¯ç‹¬ç«‹çš„ç±»
- é€šè¿‡ç»„åˆå®ç°å¤æ‚åŠŸèƒ½

### 3. é…ç½®é©±åŠ¨
- ä½¿ç”¨é…ç½®æ–‡ä»¶è€Œä¸æ˜¯ç¡¬ç¼–ç 
- ä¾¿äºä¿®æ”¹å’Œæ‰©å±•

### 4. çŠ¶æ€ç®¡ç†
- ä½¿ç”¨`state`å˜é‡ç®¡ç†æ¸¸æˆçŠ¶æ€ï¼ˆrunning/endedï¼‰
- ä½¿ç”¨`alive`æ ‡å¿—ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸ

---

## æ€»ç»“

è¿™ä¸ªé¡¹ç›®çš„æ ¸å¿ƒæ€æƒ³ï¼š
1. **æ¸¸æˆå¾ªç¯**ï¼šäº‹ä»¶ â†’ æ›´æ–° â†’ æ¸²æŸ“
2. **å¯¹è±¡ç®¡ç†**ï¼šä½¿ç”¨ç±»å’Œç²¾çµç»„ç®¡ç†æ¸¸æˆå¯¹è±¡
3. **é…ç½®é©±åŠ¨**ï¼šä½¿ç”¨é…ç½®æ–‡ä»¶ç®¡ç†æ¸¸æˆå‚æ•°
4. **ç¢°æ’æ£€æµ‹**ï¼šä½¿ç”¨çŸ©å½¢ç¢°æ’æ£€æµ‹
5. **çŠ¶æ€åŒæ­¥**ï¼šé€šè¿‡æ›´æ–°æ–¹æ³•åŒæ­¥æ¸¸æˆçŠ¶æ€

å¸Œæœ›è¿™ä»½æ–‡æ¡£èƒ½å¸®åŠ©ä½ åœ¨è€å¸ˆæé—®æ—¶è‡ªä¿¡åœ°å›ç­”ï¼ğŸ’ª

